{% load static %}
{% load currency_filters %}
{% load number_filters %}
{% load add_decimal %}
<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" type="text/css" href="{% static 'css/cash-flow.css' %}">
    <link rel="stylesheet" type="text/css" href="{% static 'css/styles.css' %}">
    <link rel="icon" href="{% static 'favicon.png' %}" type="image/x-icon">
    <title>Spifex | Fluxo de Caixa</title>
</head>
<body>
    <nav class="navigation-bar">
        <div class="navigation-bar__logo">
            <a href="{% url 'cash_flow:cash_flow' %}" class="navigation-bar__logo--spifex-logo">Spifex</a>
        </div>
        <div class="navigation-bar__tabs">
            <div class="navigation-bar__tabs--tabs">
                <div class="tabs__buttons-list">
                    <a href="{% url 'cash_flow:cash_flow' %}"><button class="tab-button tabs__buttons-list--cash-flow-page">Fluxo de Caixa</button></a>
                    <a href="{% url 'settled_entry:settled_entry' %}"><button class="tab-button tabs__buttons-list--settled-page">Realizado</button></a>
                    <a href="{% url 'reports:reports' %}"><button class="tab-button tabs__buttons-list--reports-page">Relatórios</button></a>
                    <div class="tabs__buttons-list--profile-container">
                        <button class="profile-container__account-button">
                            <span class="profile-container__account-button--typography">
                                <div class="profile-container__account-button--details">
                                    <span class="details__text">Perfil</span>
                                        <div class="profile-container__content--svg">
                                            <svg fill="none" viewBox="0 0 24 24" role="none" style="flex: 1 1 0%;"><path fill="currentColor" fill-rule="evenodd" d="m12 17.338 9.665-8.59-1.33-1.495L12 14.662l-8.335-7.41-1.33 1.495L12 17.338Z" clip-rule="evenodd"></path>
                                            </svg>
                                        </div>
                                </div>
                            </span>
                        </button>
                        <div class="profile-dropdown-menu" style="display: none;">
                            <span class="profile-dropdown-menu__item">
                                <a class="profile-dropdown-menu__item--link" href="{% url 'settings:settings' %}">
                                    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 24 24" color="#202020" height="20" width="20" xmlns="http://www.w3.org/2000/svg" style="color: #202020;"><path fill="none" d="M0 0h24v24H0z"></path><path d="M12 7V3H2v18h20V7H12zM6 19H4v-2h2v2zm0-4H4v-2h2v2zm0-4H4V9h2v2zm0-4H4V5h2v2zm4 12H8v-2h2v2zm0-4H8v-2h2v2zm0-4H8V9h2v2zm0-4H8V5h2v2zm10 12h-8v-2h2v-2h-2v-2h2v-2h-2V9h8v10zm-2-8h-2v2h2v-2zm0 4h-2v2h2v-2z"></path>
                                    </svg><span class="link__description">Configurações da Empresa</span>
                                </a>
                            </span>
                            <a href="#">
                                <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 24 24" color="#202020" height="20" width="20" xmlns="http://www.w3.org/2000/svg" style="color: #202020;"><path fill="none" d="M0 0h24v24H0z"></path><path d="M16 11c1.66 0 2.99-1.34 2.99-3S17.66 5 16 5c-1.66 0-3 1.34-3 3s1.34 3 3 3zm-8 0c1.66 0 2.99-1.34 2.99-3S9.66 5 8 5C6.34 5 5 6.34 5 8s1.34 3 3 3zm0 2c-2.33 0-7 1.17-7 3.5V19h14v-2.5c0-2.33-4.67-3.5-7-3.5zm8 0c-.29 0-.62.02-.97.05 1.16.84 1.97 1.97 1.97 3.45V19h6v-2.5c0-2.33-4.67-3.5-7-3.5z"></path></svg>
                                <span>Configurações Pessoais</span>
                            </a>
                            <a href="#">
                                <svg xmlns="http://www.w3.org/2000/svg" color="#202020" width="20" height="20" fill="currentColor" class="bi bi-bell-fill" viewBox="0 0 16 16" style="color: #202020;">
                                <path d="M8 16a2 2 0 0 0 2-2H6a2 2 0 0 0 2 2m.995-14.901a1 1 0 1 0-1.99 0A5 5 0 0 0 3 6c0 1.098-.5 6-2 7h14c-1.5-1-2-5.902-2-7 0-2.42-1.72-4.44-4.005-4.901"/>
                              </svg>
                              <span>Preferências de Notificação</span>
                            </a>
                            <a href="#">
                                <svg xmlns="http://www.w3.org/2000/svg" color="#b90000" width="20" height="20" fill="currentColor" class="bi bi-box-arrow-right" viewBox="0 0 16 16" style="color: #b90000;">
                                <path fill-rule="evenodd" d="M10 12.5a.5.5 0 0 1-.5.5h-8a.5.5 0 0 1-.5-.5v-9a.5.5 0 0 1 .5-.5h8a.5.5 0 0 1 .5.5v2a.5.5 0 0 0 1 0v-2A1.5 1.5 0 0 0 9.5 2h-8A1.5 1.5 0 0 0 0 3.5v9A1.5 1.5 0 0 0 1.5 14h8a1.5 1.5 0 0 0 1.5-1.5v-2a.5.5 0 0 0-1 0z"/>
                                <path fill-rule="evenodd" d="M15.854 8.354a.5.5 0 0 0 0-.708l-3-3a.5.5 0 0 0-.708.708L14.293 7.5H5.5a.5.5 0 0 0 0 1h8.793l-2.147 2.146a.5.5 0 0 0 .708.708z"/>
                                </svg>
                              <span style="color: #b90000;">Sair</span>
                            </a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </nav>
    <!-- ############### Metade Lateral da Página ############### -->
    <main class="main">
        <nav class="side-navigation" style="width: 60px;">
            <div class="side-navigation__buttons-list" style="width: 60px;">
                <li class="side-navigation__buttons-list--list">
                    <button class="credit credit-button list__button" id="credit-button">
                        <svg data-value-pt="Recebimentos" xmlns="http://www.w3.org/2000/svg" color="#202020" width="24" height="24" fill="currentColor" class="bi bi-box-arrow-in-up-right" viewBox="0 0 16 16">
                            <path fill-rule="evenodd" d="M6.364 13.5a.5.5 0 0 0 .5.5H13.5a1.5 1.5 0 0 0 1.5-1.5v-10A1.5 1.5 0 0 0 13.5 1h-10A1.5 1.5 0 0 0 2 2.5v6.636a.5.5 0 1 0 1 0V2.5a.5.5 0 0 1 .5-.5h10a.5.5 0 0 1 .5.5v10a.5.5 0 0 1-.5.5H6.864a.5.5 0 0 0-.5.5"/>
                            <path fill-rule="evenodd" d="M11 5.5a.5.5 0 0 0-.5-.5h-5a.5.5 0 0 0 0 1h3.793l-8.147 8.146a.5.5 0 0 0 .708.708L10 6.707V10.5a.5.5 0 0 0 1 0z"/>
                          </svg>
                    </button>
                </li>
                <li class="side-navigation__buttons-list--list">
                    <button class="debit debit-button list__button" id="debit-button">
                        <svg data-value-pt="Pagamentos" xmlns="http://www.w3.org/2000/svg" color="#202020" width="24" height="24" fill="currentColor" class="bi bi-box-arrow-down-right" viewBox="0 0 16 16">
                            <path fill-rule="evenodd" d="M8.636 12.5a.5.5 0 0 1-.5.5H1.5A1.5 1.5 0 0 1 0 11.5v-10A1.5 1.5 0 0 1 1.5 0h10A1.5 1.5 0 0 1 13 1.5v6.636a.5.5 0 0 1-1 0V1.5a.5.5 0 0 0-.5-.5h-10a.5.5 0 0 0-.5.5v10a.5.5 0 0 0 .5.5h6.636a.5.5 0 0 1 .5.5"/>
                            <path fill-rule="evenodd" d="M16 15.5a.5.5 0 0 1-.5.5h-5a.5.5 0 0 1 0-1h3.793L6.146 6.854a.5.5 0 1 1 .708-.708L15 14.293V10.5a.5.5 0 0 1 1 0z"/>
                          </svg>
                    </button>
                </li>
                <li class="side-navigation__buttons-list--list">
                    <button class="transferences transference-button list__button" id="transference-button">
                        <svg data-value-pt="Transferências" xmlns="http://www.w3.org/2000/svg" color="#202020" width="24" height="24" fill="currentColor" class="bi bi-shuffle" viewBox="0 0 16 16">
                            <path fill-rule="evenodd" d="M0 3.5A.5.5 0 0 1 .5 3H1c2.202 0 3.827 1.24 4.874 2.418.49.552.865 1.102 1.126 1.532.26-.43.636-.98 1.126-1.532C9.173 4.24 10.798 3 13 3v1c-1.798 0-3.173 1.01-4.126 2.082A9.6 9.6 0 0 0 7.556 8a9.6 9.6 0 0 0 1.317 1.918C9.828 10.99 11.204 12 13 12v1c-2.202 0-3.827-1.24-4.874-2.418A10.6 10.6 0 0 1 7 9.05c-.26.43-.636.98-1.126 1.532C4.827 11.76 3.202 13 1 13H.5a.5.5 0 0 1 0-1H1c1.798 0 3.173-1.01 4.126-2.082A9.6 9.6 0 0 0 6.444 8a9.6 9.6 0 0 0-1.317-1.918C4.172 5.01 2.796 4 1 4H.5a.5.5 0 0 1-.5-.5"/>
                            <path d="M13 5.466V1.534a.25.25 0 0 1 .41-.192l2.36 1.966c.12.1.12.284 0 .384l-2.36 1.966a.25.25 0 0 1-.41-.192m0 9v-3.932a.25.25 0 0 1 .41-.192l2.36 1.966c.12.1.12.284 0 .384l-2.36 1.966a.25.25 0 0 1-.41-.192"/>
                          </svg>
                    </button>
                </li>
                <div class="list__line">
                    <hr class="list__line--line" orientation="horizontal" width="0.5" role="separator" aria-orientation="horizontal">
                </div>
                <li class="side-navigation__buttons-list--list">
                    <button class="list__button list__button--filter-button">
                        <svg data-value-pt="Filtros" xmlns="http://www.w3.org/2000/svg" color="#202020" width="24" height="24" fill="currentColor" class="bi bi-funnel-fill" viewBox="0 0 16 16">
                            <path d="M1.5 1.5A.5.5 0 0 1 2 1h12a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-.128.334L10 8.692V13.5a.5.5 0 0 1-.342.474l-3 1A.5.5 0 0 1 6 14.5V8.692L1.628 3.834A.5.5 0 0 1 1.5 3.5z"/>
                          </svg>
                    </button>
                </li>
                <li class="side-navigation__buttons-list--operations side-navigation__buttons-list--list">
                    <button class="list__button list__button--settle-button" id="list__button--settle-button">
                        <svg data-value-pt="Liquidar" xmlns="http://www.w3.org/2000/svg" color="#202020" width="24" height="24" fill="currentColor" class="bi bi-file-earmark-lock2" viewBox="0 0 16 16">
                            <path d="M10 7v1.076c.54.166 1 .597 1 1.224v2.4c0 .816-.781 1.3-1.5 1.3h-3c-.719 0-1.5-.484-1.5-1.3V9.3c0-.627.46-1.058 1-1.224V7a2 2 0 1 1 4 0M7 7v1h2V7a1 1 0 0 0-2 0"/>
                            <path d="M14 14V4.5L9.5 0H4a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h8a2 2 0 0 0 2-2M9.5 3A1.5 1.5 0 0 0 11 4.5h2V14a1 1 0 0 1-1 1H4a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1h5.5z"/>
                        </svg>
                    </button>
                </li>
                <li class="side-navigation__buttons-list--operations side-navigation__buttons-list--list">
                    <button class="list__button list__button--delete-button" id="list__button--delete-button">
                        <svg data-value-pt="Deletar" xmlns="http://www.w3.org/2000/svg" color="#202020" width="24" height="24" fill="currentColor" class="bi bi-trash3" viewBox="0 0 16 16">
                            <path d="M6.5 1h3a.5.5 0 0 1 .5.5v1H6v-1a.5.5 0 0 1 .5-.5M11 2.5v-1A1.5 1.5 0 0 0 9.5 0h-3A1.5 1.5 0 0 0 5 1.5v1H1.5a.5.5 0 0 0 0 1h.538l.853 10.66A2 2 0 0 0 4.885 16h6.23a2 2 0 0 0 1.994-1.84l.853-10.66h.538a.5.5 0 0 0 0-1zm1.958 1-.846 10.58a1 1 0 0 1-.997.92h-6.23a1 1 0 0 1-.997-.92L3.042 3.5zm-7.487 1a.5.5 0 0 1 .528.47l.5 8.5a.5.5 0 0 1-.998.06L5 5.03a.5.5 0 0 1 .47-.53Zm5.058 0a.5.5 0 0 1 .47.53l-.5 8.5a.5.5 0 1 1-.998-.06l.5-8.5a.5.5 0 0 1 .528-.47M8 4.5a.5.5 0 0 1 .5.5v8.5a.5.5 0 0 1-1 0V5a.5.5 0 0 1 .5-.5"/>
                          </svg>
                    </button>
                </li>
                <li class="side-navigation__buttons-list--operations side-navigation__buttons-list--list">
                    <button class="list__button list__button--cancel-button" id="list__button--cancel-button">
                        <svg data-value-pt="Cancelar" xmlns="http://www.w3.org/2000/svg" color="#202020" width="24" height="24" fill="currentColor" class="bi bi-x-circle" viewBox="0 0 16 16">
                            <path d="M8 15A7 7 0 1 1 8 1a7 7 0 0 1 0 14m0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16"/>
                            <path d="M4.646 4.646a.5.5 0 0 1 .708 0L8 7.293l2.646-2.647a.5.5 0 0 1 .708.708L8.707 8l2.647 2.646a.5.5 0 0 1-.708.708L8 8.707l-2.646 2.647a.5.5 0 0 1-.708-.708L7.293 8 4.646 5.354a.5.5 0 0 1 0-.708"/>
                          </svg>
                    </button>
                </li>
                <div class="side-navigation__buttons-list--expand-button">
                    <div class="expand-button__container">
                        <button class="expand-button__container--expand-button">
                            <div class="expand-button__svg">
                                <svg fill="none" viewBox="0 0 24 24" role="none" style="flex: 1 1 0%;"><path fill="currentColor" fill-rule="evenodd" d="m17.338 12-8.59 9.664-1.495-1.328L14.662 12l-7.41-8.336 1.495-1.328L17.337 12Z" clip-rule="evenodd"></path></svg>
                            </div>
                        </button>
                    </div>
                </div>
            </div>
        </nav>
        <div class="second-tab filter-tab">
            <div class="box-grid">
                <form id="form-filters" method="get">
                    <div class="box-grid-filters">
                        <!-- ############### Filtro Bancos ############### -->
                        <section class="flex">
                            <label for="dropdown-button-banks">Bancos</label>
                            <div class="dropdown-multiselect">
                                <button type="button" onclick="toggleDropdown('dropdown-content-banks', event)" id="dropdown-button-banks" class="dropdown-button">Selecione</button>
                                <div id="dropdown-content-banks" class="dropdown-content">
                                    <div class="dropdown-header">
                                        <button class="button-select-all" type="button" onclick="toggleAllCheckboxes('#dropdown-content-banks', true)">Selecionar Todos</button>
                                        <button class="button-deselect-all" type="button" onclick="toggleAllCheckboxes('#dropdown-content-banks', false)">Desmarcar Todos</button>
                                    </div>
                                    <div class="dropdown-options">
                                        {% for banks_item in Banks_list %}
                                        <label>
                                            <input id="checkbox-bank-{{ banks_item.id }}" type="checkbox" class="checkbox-bank" value="{{ banks_item.id }}" data-bank-id="{{ banks_item.id }}">
                                            {{ banks_item.banco }}
                                        </label>
                                        {% endfor %}
                                    </div>
                                </div>
                            </div>
                        </section>
                        <!-- ############### Filtro Data Início ############### -->
                        <section class="flex">
                            <label for="start-date">De</label>
                            <input id="start-date" class="start-date" name="start_date" type="date">
                        </section>
                        <!-- ############### Filtro Data Fim ############### -->
                        <section class="flex">
                            <label for="end-date">Até</label>
                            <input id="end-date" class="end-date" name="end_date" type="date">
                        </section>
                        <!-- ############### Filtro transaction_type ############### -->
                        <section class="flex">
                            <label for="dropdown-button-transaction-type">Natureza</label>
                            <div class="dropdown-multiselect">
                                <button type="button" onclick="toggleDropdown('dropdown-content-transaction-type', event)" id="dropdown-button-transaction-type" class="dropdown-button">Crédito, Débito</button>
                                <div id="dropdown-content-transaction-type" class="dropdown-content">
                                    <div class="dropdown-header">
                                        <button class="button-select-all" type="button" onclick="toggleAllCheckboxes('#dropdown-content-transaction-type', true)">Selecionar Todos</button>
                                        <button class="button-deselect-all" type="button" onclick="toggleAllCheckboxes('#dropdown-content-transaction-type', false)">Desmarcar Todos</button>
                                    </div>
                                    <div class="dropdown-options">
                                        <label class="label-filters">
                                            <input class="transaction-type-checkbox" name="transaction_type" type="checkbox" value="Crédito">
                                            Crédito
                                        </label>
                                        <label class="label-filters">
                                            <input class="transaction-type-checkbox" name="transaction_type" type="checkbox" value="Débito">
                                            Débito
                                        </label>
                                    </div>
                                </div>
                            </div>
                        </section>
                    </div>
                </form>
            </div>
        </div>
        <main class="main-content">
            <div class="main-content__header">
                <div class="page-title-search-container">
                    <div class="page-title-container">
                        <span class="page-title-container__title">Fluxo de Caixa</span>
                    </div>
                    <!-- ############### Filtros de Palavras-Chave ############### -->
                    <div class="search-content-container">
                        <div class="search-content-container__block">
                            <label for="search-bar-box">Palavras-Chave</label>
                            <div class="block__search search-key-words-container">
                                <input type="text" class="block__search--input search-bar-box" id="search-bar-box" name="search_bar_box" placeholder="Pesquisar">
                            </div>
                        </div>
                        <!-- ############### Filtros de Tags ############### -->
                        <div class="search-content-container__block">
                            <label for="search-tags-bar-box">Tags</label>
                            <div class="block__search search-tags-container">
                                <input type="text" class="block__search--input search-tags-bar-box" id="search-tags-bar-box"  name="search_tags_bar_box" placeholder="Tags">
                            </div>
                        </div>
                        <!-- ############### Filtro months ############### -->
                        <div class="search-content-container__block">
                            <label for="dropdown-button-months">Meses</label>
                            <div class="dropdown-multiselect">
                                <button type="button" onclick="toggleDropdown('dropdown-content-months', event)" id="dropdown-button-months" class="dropdown-button">Selecione</button>
                                <div id="dropdown-content-months" class="dropdown-content">
                                    <div class="dropdown-header">
                                        <button class="button-select-all" type="button" onclick="toggleAllCheckboxes('#dropdown-content-months', true)">Selecionar Todos</button>
                                        <button class="button-deselect-all" type="button" onclick="toggleAllCheckboxes('#dropdown-content-months', false)">Desmarcar Todos</button>
                                    </div>
                                    <div class="dropdown-options">
                                        {% for months in Months_list_cash_flow %}
                                        <label class="label-filters">
                                            <input type="checkbox" class="checkbox-month" value="{{ months.formatted_date }}" data-start-of-month="{{ months.start_of_month|date:'Y-m-d' }}" data-end-of-month="{{ months.end_of_month|date:'Y-m-d' }}">
                                            {{ months.formatted_date }}
                                        </label>
                                        {% endfor %}
                                    </div>
                                </div>
                            </div>
                        </div>
                        <!-- ############### Filtro Contas Contábeis ############### -->
                        <div class="search-content-container__block">
                            <label for="dropdown-button-accounts">Contas Contábeis</label>
                            <div class="dropdown-multiselect">
                                <button type="button" onclick="toggleDropdown('dropdown-content-accounts', event)" id="dropdown-button-accounts" class="dropdown-button">Selecione</button>
                                <div id="dropdown-content-accounts" class="dropdown-content">
                                    <div class="dropdown-header">
                                        <button class="button-select-all" type="button" onclick="toggleAllCheckboxes('#dropdown-content-accounts', true)">Selecionar Todos</button>
                                        <button class="button-deselect-all" type="button" onclick="toggleAllCheckboxes('#dropdown-content-accounts', false)">Desmarcar Todos</button>
                                    </div>
                                    <div class="dropdown-options">
                                        {% for subgroup, accounts in Accounts_by_subgroup_list.items %}
                                            <div class="subgroup-label" data-nature="{{ accounts.0.nature }}">{{ subgroup }}</div>
                                            {% for account in accounts %}
                                                <label class="label-filters">
                                                    <input type="checkbox" class="checkbox-account" value="{{ account.uuid }}">
                                                    {{ account.account }}
                                                </label>
                                            {% endfor %}
                                        {% endfor %}
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <!-- ############### Tabela de Bancos ############### -->
                <button class="toggle-banks-btn" onclick="toggleBanks()">Bancos</button>   
                <div class="banks-table-wrapper" id="banks-table-wrapper">
                    <table class="banks-table" id="banks-table">
                        <thead class="banks-table__head">
                            <tr class="banks-table__head--row">
                                <th class="banks-col" scope="col">Banco</th>
                                <th class="bank-branch-col" scope="col">Agência</th>
                                <th class="bank-account-col" scope="col">Conta</th>
                                <th class="bank-balance-col" scope="col">Saldo</th>
                            </tr>
                        </thead>
                        <tbody class="banks-table__body">
                            {% for banks_item in Banks_list %}
                            <tr class="banks-table__body--row" scope="row" name="banco-id" data-bank-id="{{ banks_item.id }}">
                                <td class="bank-row" name="banco">{{ banks_item.banco }}</td>
                                <td class="bank-branch-row" name="bank_branch">{{ banks_item.bank_branch }}</td>
                                <td class="bank-account-row" name="bank_account">{{ banks_item.bank_account }}</td>
                                <td class="bank-balance-row" name="initial_balance">{{ banks_item.initial_balance|add_decimal:banks_item.current_balance|format_number }}</td>
                            </tr>
                            {% endfor %}
                            <tr class="total-banks-balance-row" scope="row">
                                <td class=""></td>
                                <td class=""></td>
                                <td class="total-row">Total</td>
                                <td class="total-banks-balance" name="total-banks-balance">{{ total_banks_balance|currency_br }}</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
            <!-- ############### Tabela com Lançamentos ############### -->
            <div class="cash-flow-table-wrapper">
                <table class="cash-flow-table" id="cash-flow-table">
                    <thead class="cash-flow-table__head">
                        <tr class="cash-flow-table__head--row">
                            <th class="checkbox-col" scope="col">ㅤﾠ</th>
                            <th class="due_date-col" scope="col">Vencimento</th>
                            <th class="description-col" scope="col">Descrição</th>
                            <th class="observation-col" scope="col">Observação</th>
                            <th class="installment-col" scope="col">Parcela</th>
                            <th class="debit-col" scope="col">Débito</th>
                            <th class="credit-col" scope="col">Crédito</th>
                            <th class="balance-col" scope="col">Saldo</th>
                        </tr>
                    </thead>
                    <tbody class="cash-flow-table__body" id="cash-flow-table__body">
                        {% for cash_flow_table_item in Cash_flow_table_list %}
                            {% if cash_flow_table_item.is_total %}
                                <tr class="month-totals-row">
                                    <td></td>
                                    <td colspan="4">Total do Mês {{ cash_flow_table_item.due_date|date:"m/Y" }}</td>
                                    <td class="total-debit-row">{{ cash_flow_table_item.debito|format_number }}</td>
                                    <td class="total-credit-row">{{ cash_flow_table_item.credito|format_number }}</td>
                                    <td class="total-balance-row">{{ cash_flow_table_item.saldo|format_number }}</td>
                                </tr>
                            {% else %}
                                <tr class="cash-flow-table__body--row" id="cash-flow-table__body--row"
                                data-id-row="{{ cash_flow_table_item.id }}"
                                data-general-ledger-account="{{ cash_flow_table_item.general_ledger_account }}"
                                data-uuid-general-ledger-account="{{ cash_flow_table_item.uuid_general_ledger_account }}"
                                data-transaction-type="{{ cash_flow_table_item.transaction_type }}"
                                data-notes="{{ cash_flow_table_item.notes }}"
                                data-current-installment="{{ cash_flow_table_item.current_installment }}"
                                data-total-installments="{{ cash_flow_table_item.total_installments }}"
                                data-uuid-row="{{ cash_flow_table_item.uuid_correlation }}"
                                data-document-type="{{ cash_flow_table_item.document_type }}"
                                data-uuid-document-type="{{ cash_flow_table_item.uuid_document_type }}"
                                data-department="{{ cash_flow_table_item.department }}"
                                data-uuid-department="{{ cash_flow_table_item.uuid_department }}"
                                data-periods="{{ cash_flow_table_item.periods }}"
                                data-weekend-action="{{ cash_flow_table_item.weekend_action }}"
                                scope="row">
                                    <td class="checkbox-row"><label class="checkbox-container"><input id="custom-checkbox-{{ cash_flow_table_item.id }}" class="custom-checkbox" type="checkbox"
                                        data-id="{{ cash_flow_table_item.id }}"
                                        data-uuid-row="{{ cash_flow_table_item.uuid_correlation }}"><span class="checkmark"></span></label></td>
                                    <td class="due_date-row">{{ cash_flow_table_item.due_date|date:"d/m/Y" }}</td>
                                    <td class="description-row">{{ cash_flow_table_item.description }}</td>
                                    <td class="observation-row">
                                        {{ cash_flow_table_item.observation }}
                                        <small class="tag-row">Tags: {{ cash_flow_table_item.tags }}</small>
                                    </td>
                                    <td class="installment-row">{{ cash_flow_table_item.current_installment }}/{{ cash_flow_table_item.total_installments }}</td>
                                    <input type="hidden" id="original-total-installments-credit" name="original_total_installments">
                                    <input type="hidden" id="original-total-installments-debit" name="original_total_installments">
                                    {% if cash_flow_table_item.transaction_type == 'Débito' %}
                                        <td class="debito-row">{{ cash_flow_table_item.amount|format_number }}</td>
                                        <td class="credito-row"></td>
                                    {% else %}
                                        <td class="debito-row"></td>
                                        <td class="credito-row">{{ cash_flow_table_item.amount|format_number }}</td>
                                    {% endif %}
                                    <td class="balance-row">{{ cash_flow_table_item.saldo|format_number }}</td>
                                </tr>
                            {% endif %}
                        {% endfor %}
                    </tbody>
                </table>
            </div>
            <!-- ############### Campo de saldo a liquidar ############### -->
            <div class="selected-entries-value-container">
                <div class="settlement-consolidated-value">
                    Total a liquidar:&nbsp;<label></label>
                </div>
            </div>
        </main>
        <!-- ############### Janelas/Modais de Lançamentos ############### -->
        <!-- Modal credit -->
        <dialog class="modal credit-modal" id="credit-modal">

                <div class="modal-header">
                    <h1 class="modal-title">Recebimentos</h1>
                    <div class="modal-tabs">
                        <button class="tab-link" onclick="changeTab(event, 'modal-details-tab-credit')">Detalhes</button>
                        <button class="tab-link" onclick="changeTab(event, 'modal-cost-center-tab-credit')">Centro de Custos</button>
                        <button class="tab-link" onclick="changeTab(event, 'modal-stakeholders-tab-credit')">Partes Interessadas</button>
                        <button class="tab-link" onclick="changeTab(event, 'modal-recurrence-tab-credit')">Recorrência</button>
                    </div>
                </div>
            <form class="modal-form credit-modal-form" action="/fluxo_de_caixa/" method="POST" onsubmit="return validateCheckboxes()">{% csrf_token %}
                <div id="modal-details-tab-credit" class="tab-content modal-details-tab modal-details-tab-credit">
                    <div class="modal-fields credit-modal-fields">
                        <input type="hidden" name="entry_id_credit" value="{{ cash_flow.id }}">
                        <input type="hidden" name="uuid_correlation_credit" value="{{ cash_flow.uuid_correlation }}">
                        <section class="modal-section credit-modal-form__section--date section__date">
                            <label for="date-credit">Data</label>
                            <input class="modal-date" id="date-credit" type="date" name="due_date" required>
                        </section>
                    
                        <section class="modal-section credit-modal-form__section--description section__description">
                            <label for="description-credit">Descrição</label>
                            <input class="modal-description" id="description-credit" maxlength="100" type="text" name="description" required>
                        </section>
                    
                        <section class="modal-section credit-modal-form__section--observation section__observation">
                            <label for="observation-credit">Observação</label>
                            <input class="modal-observation" id="observation-credit" maxlength="100" type="text" name="observation"></input>
                        </section>
                    
                        <section class="modal-section credit-modal-form__section--amount section__amount">
                            <label for="amount-credit">Valor</label>
                            <input class="modal-amount" id="amount-credit" type="text" name="amount" oninput="formatAmount(this)" value="R$ " required>
                        </section>
                    
                        <section class="modal-section credit-modal-form__section--general-ledger-dropdown section__general-ledger-dropdown">
                            <label for="dropdown-button-accounts-credit">Conta Contábil</label>
                            <div class="dropdown-multiselect">
                                <button type="button" onclick="toggleDropdown('dropdown-content-accounts-credit', event)" id="dropdown-button-accounts-credit" class="modal-dropdown-button dropdown-button">Selecione</button>
                                <div id="dropdown-content-accounts-credit" class="dropdown-content">
                                    <input id="modal-dropdown-button-account-search" class="modal-dropdown-button-search" type="text" oninput="filterOptions(this, 'dropdown-content-accounts-credit')" placeholder="Filtrar...">
                                    <div class="dropdown-options">
                                        {% for subgroup, accounts in Accounts_by_subgroup_list.items %}
                                            {% if accounts.0.nature == 'Crédito' %}
                                                <div class="subgroup-label">{{ subgroup }}</div>
                                                {% for account in accounts %}
                                                    <label class="label-filters">
                                                        <input type="checkbox" class="checkbox-account-modal" name="accounts_credit" data-uuid-account="{{ account.uuid }}" data-account="{{ account.account }}">
                                                        {{ account.account }}
                                                    </label>
                                                {% endfor %}
                                            {% endif %}
                                        {% endfor %}
                                        <input type="hidden" id="general-ledger-account-name-credit" name="general_ledger_account_name_credit" value="">
                                        <input type="hidden" id="general-ledger-account-uuid-credit" name="general_ledger_account_uuid_credit" value="">
                                    </div>
                                </div>
                            </div>
                        </section>

                        <section class="modal-section credit-modal-form__section--document-type section__document-type">
                            <label for="dropdown-button-document-type-credit">Tipo de Documento</label>
                            <div class="dropdown-multiselect">
                                <button type="button" onclick="toggleDropdown('dropdown-content-document-type-credit', event)" id="dropdown-button-document-type-credit" class="modal-dropdown-button dropdown-button">Selecione</button>
                                <div id="dropdown-content-document-type-credit" class="dropdown-content">
                                    <input id="modal-dropdown-button-document-type-search" class="modal-dropdown-button-search" type="text" oninput="filterOptions(this, 'dropdown-content-document-type-credit')" placeholder="Filtrar...">
                                    <div class="dropdown-options">
                                        {% for document_type in Document_types %}
                                            <label class="label-filters">
                                                <input type="checkbox" class="document-type-checkbox" name="document_type_option_credit" data-uuid-document-type="{{ document_type.uuid_document_type }}" data-document-type="{{ document_type.document_type }}">
                                                {{ document_type.document_type }}
                                            </label>
                                            {% endfor %}
                                        <input type="hidden" id="document-type-name-credit" name="document_type_name_credit" value="">
                                        <input type="hidden" id="document-type-uuid-credit" name="document_type_uuid_credit" value="">
                                    </div>
                                </div>
                            </div>
                        </section>
                        
                        <section class="modal-section credit-modal-form__section--notes section__notes mesclar-2">
                            <label for="notes-credit">Anotações</label>
                            <input id="notes-credit" class="notes-credit" name="notes" type="text">
                        </section>

                        <section class="modal-section credit-modal-form__section--tag section__tag">
                            <label for="tagInput-credit">Tags</label>
                            <input id="tagInput-credit" class="tagInput" type="text" placeholder="Adicione uma tag">
                        </section>


                        
                        <section class="modal-section credit-modal-form__section--tag-container section__tag-container">
                            <div id="tag-container-credit" class="tag-container"></div>
                            <input type="hidden" id="tagsHiddenInput-credit" name="tags">
                        </section>
                    </div>
                </div>

                <div id="modal-cost-center-tab-credit" class="tab-content modal-cost-center-tab modal-cost-center-tab-credit" style="display:none;">
                    <div class="modal-fields credit-modal-fields">
                        <section class="modal-section credit-modal-form__section--department section__department">
                            <label for="dropdown-button-department-credit">Departamento</label>
                            <div class="dropdown-multiselect">
                                <button type="button" onclick="toggleDropdown('dropdown-content-department-credit', event)" id="dropdown-button-department-credit" class="modal-dropdown-button dropdown-button">Selecione</button>
                                <div id="dropdown-content-department-credit" class="dropdown-content">
                                    <input id="modal-dropdown-button-department-search" class="modal-dropdown-button-search" type="text" oninput="filterOptions(this, 'dropdown-content-department-credit')" placeholder="Filtrar...">
                                    <div class="dropdown-options">
                                        {% for department in Departments %}
                                            <label class="label-filters">
                                                <input type="checkbox" class="department-checkbox" name="department_option_credit" data-uuid-department="{{ department.uuid_department }}" data-department="{{ department.department }}">
                                                {{ department.department }}
                                            </label>
                                            {% endfor %}
                                        <input type="hidden" id="department-name-credit" name="department_name_credit" value="">
                                        <input type="hidden" id="department-uuid-credit" name="department_uuid_credit" value="">
                                    </div>
                                </div>
                            </div>
                        </section>
                    </div>
                </div>

                <div id="modal-stakeholders-tab-credit" class="tab-content modal-stakeholders-tab modal-stakeholders-tab-credit" style="display:none;">
                    <div class="modal-fields credit-modal-fields">
                        <section class="modal-section credit-modal-form__section--department section__department">
                            <label for="dropdown-button-department-credit">Cliente</label>
                            <div class="dropdown-multiselect">
                                <button type="button" onclick="toggleDropdown('dropdown-content-department-credit', event)" id="dropdown-button-department-credit" class="modal-dropdown-button dropdown-button">Selecione</button>
                                <div id="dropdown-content-department-credit" class="dropdown-content">
                                    <input id="modal-dropdown-button-department-search" class="modal-dropdown-button-search" type="text" oninput="filterOptions(this, 'dropdown-content-department-credit')" placeholder="Filtrar...">
                                    <div class="dropdown-options">
                                        {% for department in Departments %}
                                            <label class="label-filters">
                                                <input type="checkbox" class="department-checkbox" name="department_option_credit" data-uuid-department="{{ department.uuid_department }}" data-department="{{ department.department }}">
                                                {{ department.department }}
                                            </label>
                                            {% endfor %}
                                        <input type="hidden" id="department-name-credit" name="department_name_credit" value="">
                                        <input type="hidden" id="department-uuid-credit" name="department_uuid_credit" value="">
                                    </div>
                                </div>
                            </div>
                        </section>
                    </div>
                </div>

                <div id="modal-recurrence-tab-credit" class="tab-content modal-recurrence-tab modal-recurrence-tab-credit" style="display:none;">
                    <div class="modal-fields credit-modal-fields">
                        <div class="credit-modal-form__installments-container installments-container mesclar-2">
                            <section class="modal-section credit-modal-form__section--recurrence section__recurrence">
                                <label for="recurrence-credit" class="recurrence-label">Recorrência</label>
                                <select class="modal-recurrence" id="recurrence-credit" name="recurrence" required onchange="showInstallments(null, 'credit')">
                                    <option value="no">Não</option>
                                    <option value="yes">Sim</option>
                                </select>
                            </section>
                            <section class="modal-section credit-modal-form__section--installments-number section__installments-number" id="section-installments-number-credit" style="display:none;">
                                <label for="installments-credit">Número de Parcelas</label>
                                <input class="modal-installments" id="installments-number-credit" type="number" name="installments" data-current-installment="{{ cash_flow.current_installment }}" data-total-installments="{{ cash_flow.total_installments }}" min="1" value="1">
                            </section>
                            <section class="modal-section credit-modal-form__section--periods section__periods" id="section-periods-credit" style="display:none;">
                                <label for="periods-credit">Períodos</label>
                                <select class="periods-credit" id="periods-credit" name="periods_credit">
                                    <option value="monthly">Mensal</option>
                                    <option value="weekly">Semanal</option>
                                    <option value="bimonthly">Bimestral</option>
                                    <option value="semiannual">Semestral</option>
                                    <option value="yearly">Anual</option>
                                </select>
                            </section>
                            <section class="modal-section credit-modal-form__section--weekend section__weekend" id="section-weekend-credit" style="display:none;">
                                <label>Finais de Semana</label>
                                <div class="weekend-container">
                                    <div class="weekend-checkbox-container">
                                        <label class="weekend-label" for="custom-checkbox-antedate-credit">Antecipar</label>
                                        <label class="checkbox-container-weekend"><input id="custom-checkbox-antedate-credit" class="custom-checkbox-weekend checkbox-weekend" type="checkbox"><span class="checkmark-weekend"></span></label>
                                    </div>
                                    <div class="weekend-checkbox-container">
                                        <label class="weekend-label" for="custom-checkbox-postpone-credit">Postergar</label>
                                        <label class="checkbox-container-weekend"><input id="custom-checkbox-postpone-credit" class="custom-checkbox-weekend checkbox-weekend" type="checkbox"><span class="checkmark-weekend"></span></label>
                                    </div>
                                </div>
                                <input type="hidden" id="weekend-action-credit" name="weekend_action_credit" value="">
                            </section>
                        </div>
                    </div>
                </div>

                <section class="modal-buttons">
                    <input type="submit" class="modal-save-button" name="modal_save_credit" value="Salvar">
                    <button type="button" class="modal-close-credit">Cancelar</button>
                </section>
            </form>
        </dialog>

        <!-- Modal debit -->
        <dialog class="modal debit-modal" id="debit-modal">

            <h1 class="modal-title">Pagamentos</h1>
            
            <form class="modal-form debit-modal-form" action="/fluxo_de_caixa/" method="POST">{% csrf_token %}
                <input type="hidden" name="entry_id_debit" value="{{ cash_flow.id }}">
                <input type="hidden" name="uuid_debit" value="{{ cash_flow.uuid_correlation }}">
                <section class="modal-section">
                    <label for="date-debit">Data</label>
                    <input class="modal-date" type="date" id="date-debit" name="due_date" required><br>
                </section>
            
                <section class="modal-section">
                    <label for="description-debit">Descrição</label>
                    <input class="modal-description" id="description-debit" maxlength="100" type="text" name="description" required><br>
                </section>
            
                <section class="modal-section">
                    <label for="observation-debit">Observação</label>
                    <input class="modal-observation" id="observation-debit" maxlength="100" type="text" name="observation"></input><br>
                </section>
                
                <section class="modal-section">
                    <label for="amount-debit">Valor</label>
                    <input class="modal-amount" id="amount-debit" type="text" name="amount" oninput="formatAmount(this)" value="R$ " required><br>
                </section>
            
                <section class="modal-section">
                    <label for="dropdown-button-accounts-debit">Conta Contábil</label>
                    <div class="dropdown-multiselect">
                        <button type="button" onclick="toggleDropdownModals('dropdown-content-accounts-debit', event)" id="dropdown-button-accounts-debit" class="dropdown-button">Selecione</button>
                        <div id="dropdown-content-accounts-debit" class="dropdown-content">
                            <div class="dropdown-options">
                                {% for subgroup, accounts in Accounts_by_subgroup_list.items %}
                                    {% if accounts.0.nature == 'Débito' %}
                                        <div class="subgroup-label">{{ subgroup }}</div>
                                        {% for account in accounts %}
                                            <label class="label-filters">
                                                <input type="checkbox" name="contas_debit" data-uuid-account="{{ account.uuid }}" data-account="{{ account.account }}" class="checkbox-account">
                                                {{ account.account }}
                                            </label>
                                        {% endfor %}
                                    {% endif %}
                                {% endfor %}
                                <input type="hidden" id="general-ledger-account-name-debit" name="general_ledger_account_name_debit" value="">
                                <input type="hidden" id="general-ledger-account-uuid-debit" name="general_ledger_account_uuid_debit" value="">
                            </div>
                        </div>
                    </div>
                </section>
            
                <section class="modal-section">
                    <label for="recurrence-debit" class="recurrence-label">Recorrência</label>
                    <select class="modal-recurrence" id="recurrence-debit" name="recurrence" required onchange="showInstallments(null, 'debit')">
                        <option value="no">Não</option>
                        <option value="yes">Sim</option>
                    </select><br>
                </section>
            
                <section class="modal-section mesclar-2" id="installment-number-debit" style="display:none;">
                    <label for="installments-debit">Número de Parcelas</label>
                    <input class="modal-installments" id="installments-number-debit" type="number" name="installments" data-current-installment="{{ cash_flow.current_installment }}" data-total-installments="{{ cash_flow.total_installments }}" min="1" value="1"><br>
                </section>

                <section class="modal-section mesclar-2">
                    <div id="tag-container-debit" class="tag-container">
                    </div>
                    <input type="text" id="tagInput-debit" class="tagInput" placeholder="Adicione uma tag">
                    <input type="hidden" id="tagsHiddenInput-debit" name="tags">
                </section>
                <section class="modal-buttons">
                    <input type="submit" class="modal-save-button" name="salvar_debit" value="Salvar">
                    <button type="button" class="modal-close-debit">Cancelar</button>
                </section>
            </form>
        </dialog>

        <!-- Modal Transferências -->    
        <dialog class="modal transference-modal">

            <h1 class="modal-title">Transferências</h1>
            
            <form class="modal-form modal-form-transferences" action="/fluxo_de_caixa/" method="POST">{% csrf_token %}
                <input type="hidden" name="transferences" value="process_transfer">
                <section class="modal-section">
                    <label for="date-transferences">Data</label>
                    <input class="modal-date" id="date-transferences" type="date" name="transfer_date" required><br>
                </section>
                
                <section class="modal-section">
                    <label for="amount-transferences">Valor</label>
                    <input class="modal-amount" id="amount-transferences" type="text" name="amount" oninput="formatAmount(this)" value="R$ " required><br>
                </section>
                
                <section class="modal-section">
                    <label for="banco-saida">Do banco</label>
                    <select class="modal-banco-saida" id="banco-saida" name="banco_saida" required>
                        <option value="" disabled selected hidden>Selecione</option>
                        {% for banks_item in Banks_list %}
                        <option value="{{ banks_item.id }}|{{ banks_item.banco }}">{{ banks_item.banco }}</option>
                        {% endfor %}
                    </select><br>
                </section>
                <section class="modal-section">
                    <label for="banco-entrada">Para o banco</label>
                    <select class="modal-banco-entrada" id="banco-entrada" name="banco_entrada" required>
                        <option value="" disabled selected hidden>Selecione</option>
                        {% for banks_item in Banks_list %}
                        <option value="{{ banks_item.id }}|{{ banks_item.banco }}">{{ banks_item.banco }}</option>
                        {% endfor %}
                    </select><br>
                </section>
            
                <section class="modal-section mesclar-2">
                    <label for="observation-transferencia">Observação</label>
                    <input class="modal-description" id="observation-transferencia" type="text" name="observation"><br>
                </section>
                <section class="modal-buttons mesclar-2">
                    <input class="modal-save-button" name="salvar_transferencias" type="submit" value="Salvar">
                    <button type="button" class="modal-close-transferences">Cancelar</button>
                </section>
            </form>
        </dialog>

        <!-- Modal Liquidação -->
        <dialog class="modal modal-liquidacoes" id="modal-liquidacoes">
            <h1 class="modal-title">Liquidar</h1>
            
            <form class="modal-form-liquidacoes" action="/fluxo_de_caixa/" method="POST">{% csrf_token %}
                <input type="hidden" name="liquidacoes" value="liquidacoes">
                <input type="hidden" name="uuid" data-uuid-row="{{ cash_flow.uuid_correlation }}">
                <section class="mesclar-3">
                    <div class="banks-table-settlement-wrapper" id="banks-table-settlement-wrapper">
                            <table class="banks-table-settlement" id="banks-table-settlement">
                                <thead class="banks-table__head">
                                    <tr class="banks-table__head--row">
                                        <th class="checkbox-col" scope="col"></th>
                                        <th class="bancos-bancos-liquidacao-col" scope="col">Contas</th>
                                        <th class="ag-bancos-liquidacao-col" scope="col">Agência</th>
                                        <th class="conta-bancos-liquidacao-col" scope="col">Contas</th>
                                        <th class="saldo-bancos-liquidacao-col" scope="col">Saldo</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    {% for banks_item in Banks_list %}
                                    <tr class="banks-table-settle__body--row" scope="row">
                                        <td class="checkbox-row"><label class="checkbox-container-liquidacao"><input id="custom-checkbox-liquidacao-{{ banks_item.id }}" class="custom-checkbox-liquidacao" type="checkbox"><span class="checkmark-liquidacao"></span></label></td>
                                        <td class="bank-row banco-liquidacao" name="banco" data-bank-name="{{ banks_item.banco }}" data-bank-id="{{ banks_item.id }}">{{ banks_item.banco }}</td>
                                        <td class="bank-branch-row" name="bank_branch">{{ banks_item.bank_branch }}</td>
                                        <td class="bank-account-row" name="bank_account">{{ banks_item.bank_account }}</td>
                                        <td class="saldo-banco-liquidacao-row" name="initial_balance">{{ banks_item.initial_balance|add:banks_item.current_balance|format_number }}</td>
                                    </tr>
                                    {% endfor %}
                                    <tr class="total-banks-balance-row" scope="row">
                                        <td class=""></td>
                                        <td class=""></td>
                                        <td class=""></td>
                                        <td class="total-row">Total</td>
                                        <td class="total-banks-settlement-balance" name="total-banks-settlement-balance">{{ total_banks_balance|currency_br }}</td>
                                    </tr>
                                </tbody>
                            </table>

                    </div>
                </section>

                <!-- Contêiner para os lançamentos selecionados -->
                <div class="selected-entries-list-labels mesclar-3">
                    <label>Data de Liquidação</label>
                    <label>Descrição</label>
                    <label>Observação</label>
                    <label>Valor</label>
                    <label>Natureza</label>
                    <label></label>
                    <label class="label-parcial" style="display:none;">Parcial</label>
                </div>
                <div class="selected-entries-list mesclar-3" id="selected-entries-list">
                    <!-- Itens dinâmicos serão adicionados aqui -->
                </div>
        
                <section class="modal-buttons mesclar-3">
                    <div class="saldo-liquidacao">
                        <div class="titulo-saldo-liquidacao">SALDO:</div>
                        <div name="saldo-liquidacao">R$ 0,00</div>
                    </div>
                    <input type="submit" class="modal-save-button" id="salvar-liquidacao" name="salvar_liquidacao" value="Liquidar">
                    <button type="button" class="modal-close-liquidacoes">Cancelar</button>
                </section>
            </form>
        </dialog>
    </main>
    <script src="{% static 'scripts/scripts_cash_flow.js' %}"></script>
</body>
</html>